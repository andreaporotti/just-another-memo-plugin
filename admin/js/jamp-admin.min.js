(function(a){a(function(){function h(b){""!==b&&null!==b?a.post(jamp_ajax.ajax_url,{_ajax_nonce:jamp_ajax.nonce,action:"build_targets_list",target_type:b},function(b){if(b.success){let c="";a.each(b.data,function(a,b){c+=`<option class="target-entity" value="${b.id}">${b.title} (${b.status})</option>`});a("#jamp_meta_box #target option.target-entity").remove();a("#jamp_meta_box #target").append(c);b=a("#jamp_meta_box #saved-target").val();0<a(`#jamp_meta_box #target option[value="${b}"]`).length?
a("#jamp_meta_box #target").val(b):a("#jamp_meta_box #target").val("")}else alert(jamp_strings.get_entities_list_error)}):a("#jamp_meta_box #target option.target-entity").remove()}function d(b){0>a.inArray(".meta-section",b)&&(a("#jamp_meta_box .meta-section").hide().find("option:first").attr("selected","selected"),a("#jamp_meta_box #section").removeClass("form-field-invalid"));0>a.inArray(".meta-target-type",b)&&(a("#jamp_meta_box .meta-target-type").hide().find("option:first").attr("selected","selected"),
a("#jamp_meta_box #target-type").removeClass("form-field-invalid"));0>a.inArray(".meta-target",b)&&(a("#jamp_meta_box .meta-target").hide().find("option:first").attr("selected","selected"),a("#jamp_meta_box #target").removeClass("form-field-invalid"))}function f(b){switch(b){case "global":d();break;case "section":d([".meta-section"]);a("#jamp_meta_box .meta-section").show();break;case "entity":d([".meta-target-type",".meta-target"]),a("#jamp_meta_box .meta-target-type").show(),a("#jamp_meta_box #target-type").trigger("change"),
a("#jamp_meta_box .meta-target").show()}}function g(b,c){""!==b&&null!==b&&a.post(jamp_ajax.ajax_url,{_ajax_nonce:jamp_ajax.nonce,action:"move_to_trash",note:b},function(a){a.success?"column"===c?k(b):"adminbar"===c&&l(b):alert(jamp_strings.move_to_trash_error)})}function k(b){b=a(".jamp-column-note[data-note="+b+"]");let c=b.parent("td"),e=c.find(".jamp-column-note").length;b.addClass("jamp-column-note--red-background").fadeOut(600,function(){a(this).remove();0===e-1&&c.find(".jamp-column-note__no-notes-notice").removeClass("jamp-column-note__no-notes-notice--hidden")})}
function l(b){b=a(".jamp-admin-bar-note[data-note="+b+"]");let c=b.data("scope"),e=b.parent(".jamp-admin-bar-section"),d=e.find(".jamp-admin-bar-note").length;b.addClass("jamp-admin-bar-note--red-background").fadeOut(600,function(){a(this).remove();0===d-1&&e.find(".jamp-admin-bar-note__no-notes-notice").removeClass("jamp-admin-bar-note__no-notes-notice--hidden");let b;"global"===c?b=a("#wp-admin-bar-jamp .global-notes-count"):"section"===c&&(b=a("#wp-admin-bar-jamp .section-notes-count"));0===d-
1?b.remove():b.text(d-1)})}a("#jamp_meta_box #target-type").on("change",function(){h(this.value)});a("#jamp_meta_box input[type=radio][name=scope]").on("change",function(){f(this.value)});f(a("#jamp_meta_box input[type=radio][name=scope]:checked").val());a(".jamp-column-note__note-trash-action").on("click",function(b){b.preventDefault();let c=a(this);a(".jamp-trash-dialog").dialog({modal:!0,closeText:"",buttons:{OK:function(){a(this).dialog("close");g(c.data("note"),"column")}}})});a(".jamp-admin-bar-action--trash").on("click",
function(b){b.preventDefault();let c=a(this);a(".jamp-trash-dialog").dialog({modal:!0,closeText:"",buttons:{OK:function(){a(this).dialog("close");g(c.data("note"),"adminbar")}}})});a(".jamp-column-note__note-info-action").on("click",function(a){a.preventDefault()});a(".jamp-admin-bar-action--info").on("click",function(b){b.preventDefault();a(this).parent().nextAll(".jamp-admin-bar-note__details").slideToggle(100)});a(".post-type-jamp_note #publish").on("click",function(b){var c=!1;switch(a("#jamp_meta_box input[type=radio][name=scope]:checked").val()){case "global":c=
!0;break;case "section":c=a("#jamp_meta_box #section");""!==c.val()&&null!==c.val()?(c.removeClass("form-field-invalid"),c=!0):(c.addClass("form-field-invalid"),c=!1);break;case "entity":c=a("#jamp_meta_box #target-type");let b=a("#jamp_meta_box #target");""!==c.val()&&null!==c.val()?c.removeClass("form-field-invalid"):c.addClass("form-field-invalid");""!==b.val()&&null!==b.val()?(b.removeClass("form-field-invalid"),c=!0):(b.addClass("form-field-invalid"),c=!1)}!1===c&&b.preventDefault()})})})(jQuery);